use schedule;


select sk.firstname, 'music' as lesson, -- годовая оценка по музыке 
round((a1.music + a2.music + a3.music + a4.music) / 4) as annual
from appr1 a1 join appr2 a2 on a1.id_skl = a2.id_skl2
join appr3 a3 on a2.id_skl2 = a3.id_skl3
join appr4 a4 on a3.id_skl3= a4.id_skl4
join skl sk on sk.id = a4.id_skl4;


select id, firstname, -- вывод лучших учеников по музыке
(select music from annual where id_skl5 = skl.id) as music
from skl
order by music desc
limit 3; 